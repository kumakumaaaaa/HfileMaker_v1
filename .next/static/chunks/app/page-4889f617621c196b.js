(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1159:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var a=s(5155),l=s(2115);let r=[{id:"a_wounds",category:"a",label:"創傷処置",points:1,inputType:"checkbox"},{id:"a_respiratory",category:"a",label:"呼吸ケア",points:1,inputType:"checkbox"},{id:"a_infusion",category:"a",label:"点滴ライン同時3本以上の管理",points:1,inputType:"checkbox"},{id:"a_ecg",category:"a",label:"心電図モニターの管理",points:1,inputType:"checkbox"},{id:"a_syringe_driver",category:"a",label:"シリンジポンプの管理",points:1,inputType:"checkbox"},{id:"a_emergency",category:"a",label:"救急搬送後の入院/緊急入院(2日間)",points:2,inputType:"checkbox"},{id:"a_special",category:"a",label:"専門的な治療・処置(抗悪性腫瘍剤等)",points:3,inputType:"checkbox"},{id:"b_bed_mobility",category:"b",label:"寝返り",points:2,inputType:"select",hasAssistance:!1,options:[{label:"できる(0点)",value:0},{label:"何かにつかまればできる(1点)",value:1},{label:"できない(2点)",value:2}]},{id:"b_transfer",category:"b",label:"移乗",points:2,inputType:"select",hasAssistance:!0,options:[{label:"自立(0点)",value:0},{label:"一部介助(1点)",value:1},{label:"全介助(2点)",value:2}]},{id:"b_oral_care",category:"b",label:"口腔清潔",points:1,inputType:"select",hasAssistance:!0,options:[{label:"自立(0点)",value:0},{label:"要介助(1点)",value:1}]},{id:"b_eating",category:"b",label:"食事摂取",points:2,inputType:"select",hasAssistance:!0,options:[{label:"自立(0点)",value:0},{label:"一部介助(1点)",value:1},{label:"全介助(2点)",value:2}]},{id:"b_clothes",category:"b",label:"衣服の着脱",points:2,inputType:"select",hasAssistance:!0,options:[{label:"自立(0点)",value:0},{label:"一部介助(1点)",value:1},{label:"全介助(2点)",value:2}]},{id:"b_instruction",category:"b",label:"診療・療養上の指示が通じる",points:1,inputType:"select",hasAssistance:!1,options:[{label:"はい(0点)",value:0},{label:"いいえ(1点)",value:1}]},{id:"b_danger",category:"b",label:"危険行動",points:2,inputType:"select",hasAssistance:!1,options:[{label:"ない(0点)",value:0},{label:"ある(2点)",value:2}]},{id:"c_thoraco",category:"c",label:"開胸手術(9日間)",points:1,inputType:"checkbox"},{id:"c_laparo",category:"c",label:"開腹手術(6日間)",points:1,inputType:"checkbox"},{id:"c_craniotomy",category:"c",label:"開頭手術(11日間)",points:1,inputType:"checkbox"},{id:"c_other_surgery",category:"c",label:"その他手術(5日間)",points:1,inputType:"checkbox"}],n={ACUTE_GENERAL_5:{id:"acute_general_5",name:"急性期一般入院料5",thresholds:{pattern1:{a:2,b:3},pattern2:{c:1}}}},i=e=>{let{value:t,onChange:s}=e;return(0,a.jsx)("select",{value:t,onChange:e=>s(e.target.value),className:"border rounded p-2",children:Object.values(n).map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))})},c=e=>{let{patientName:t,currentDate:s,onDateChange:c,initialData:b,onSave:x,onCopyPrevious:m}=e,[u,p]=(0,l.useState)(n.ACUTE_GENERAL_5.id),[h,g]=(0,l.useState)({});(0,l.useEffect)(()=>{b?g(b):g({})},[b]);let{isSevere:y,scores:f}=(0,l.useMemo)(()=>{let e=0,t=0,s=0;return r.forEach(a=>{let l=h[a.id];if("a"===a.category&&!0===l&&(e+=a.points),"c"===a.category&&!0===l&&(s+=a.points),"b"===a.category&&"number"==typeof l){let e=l;if(a.hasAssistance){let t=h["".concat(a.id,"_assist")];e*="number"==typeof t?t:0}t+=e}}),{isSevere:function(e,t){var s,a,l,i,c,o;let d=0,b=0,x=0,m=t.items||{};r.forEach(e=>{let t=m[e.id];if("a"===e.category)!0===t&&(d+=e.points);else if("c"===e.category)!0===t&&(x+=e.points);else if("b"===e.category&&"number"==typeof t){let s=t;if(e.hasAssistance){let t=m["".concat(e.id,"_assist")];s*="number"==typeof t?t:0}b+=s}});let u=null!=(s=t.scoreA)?s:d,p=null!=(a=t.scoreB)?a:b,h=null!=(l=t.scoreC)?l:x;if(e===n.ACUTE_GENERAL_5.id){let e=n.ACUTE_GENERAL_5.thresholds,t=u>=(null!=(i=e.pattern1.a)?i:0)&&p>=(null!=(c=e.pattern1.b)?c:0),s=h>=(null!=(o=e.pattern2.c)?o:0);return t||s}return console.warn("Unknown admission fee ID: ".concat(e)),!1}(u,{items:h,scoreA:e,scoreB:t,scoreC:s}),scores:{a:e,b:t,c:s}}},[u,h]),v=Object.values(n).find(e=>e.id===u),N=(e,t)=>{g(s=>({...s,[e]:t}))},j=(0,l.useMemo)(()=>{let e={a:[],b:[],c:[]};return r.forEach(t=>{e[t.category]&&e[t.category].push(t)}),e},[]);return(0,a.jsxs)("div",{className:"flex flex-col gap-6 p-6 max-w-7xl mx-auto bg-gray-50 min-h-screen",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-4 md:mb-0",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:t?"".concat(t," 様"):"未選択"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"評価日:"}),(0,a.jsx)("input",{type:"date",value:s,onChange:e=>c(e.target.value),className:"border border-gray-300 rounded px-2 py-1 text-sm"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors text-sm font-medium",children:"\uD83D\uDCCB 前日コピー"}),(0,a.jsx)("button",{onClick:()=>{x(h,f,y),alert("保存しました")},className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors font-bold shadow-sm",children:"\uD83D\uDCBE 保存"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-8",children:[(0,a.jsxs)("div",{className:"flex-1 bg-white p-6 rounded-lg shadow-md overflow-y-auto max-h-[calc(100vh-200px)]",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-6 text-gray-800 border-b pb-2",children:"評価入力"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"入院料区分"}),(0,a.jsx)(i,{value:u,onChange:p})]}),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("section",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-blue-800 border-b pb-2 mb-4",children:"A項目 (モニタリング・処置等)"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-3",children:j.a.map(e=>(0,a.jsx)(o,{item:e,checked:!0===h[e.id],onChange:t=>N(e.id,t)},e.id))})]}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-green-800 border-b pb-2 mb-4",children:"B項目 (患者の状況等)"}),(0,a.jsx)("div",{className:"space-y-4",children:j.b.map(e=>{var t;return(0,a.jsx)(d,{item:e,value:null!=(t=h[e.id])?t:0,assistValue:e.hasAssistance?h["".concat(e.id,"_assist")]:void 0,onChange:t=>N(e.id,t),onAssistChange:t=>N("".concat(e.id,"_assist"),t)},e.id)})})]})]})]}),(0,a.jsxs)("div",{className:"w-full md:w-96 bg-white p-6 rounded-lg shadow-md h-fit sticky top-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-6 text-gray-800",children:"リアルタイム判定結果"}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-md border border-blue-100",children:[(0,a.jsx)("h3",{className:"font-semibold text-blue-800 mb-2",children:"現在の判定基準"}),(0,a.jsx)("p",{className:"text-sm text-blue-700 font-medium",children:null==v?void 0:v.name}),(0,a.jsx)("div",{className:"mt-2 text-xs text-blue-600 space-y-1",children:(0,a.jsx)("p",{children:"• パターン1: A項目2点以上 かつ B項目3点以上"})})]}),(0,a.jsxs)("div",{className:"space-y-4 mb-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"A項目 合計"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-blue-600",children:[f.a," 点"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"B項目 合計"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-green-600",children:[f.b," 点"]})]})]}),(0,a.jsxs)("div",{className:"p-6 rounded-lg text-center border-4 transition-all duration-300 transform ".concat(y?"bg-red-50 border-red-500 scale-105 shadow-xl":"bg-gray-100 border-gray-300"),children:[(0,a.jsx)("p",{className:"text-sm mb-1 uppercase tracking-wide font-bold ".concat(y?"text-red-600":"text-gray-500"),children:"判定結果"}),(0,a.jsx)("p",{className:"text-3xl font-extrabold ".concat(y?"text-red-700":"text-gray-400"),children:y?"「重症」該当":"非該当"})]})]})]})]})},o=e=>{let{item:t,checked:s,onChange:l}=e;return(0,a.jsxs)("div",{className:"\n    flex items-start p-3 border rounded-md transition-colors\n    ".concat(s?"bg-blue-50 border-blue-300":"hover:bg-gray-50 border-gray-200","\n  "),children:[(0,a.jsx)("div",{className:"flex items-center h-5",children:(0,a.jsx)("input",{id:"checkbox-".concat(t.id),type:"checkbox",className:"h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500",checked:s,onChange:e=>l(e.target.checked)})}),(0,a.jsxs)("label",{htmlFor:"checkbox-".concat(t.id),className:"ml-3 block cursor-pointer w-full",children:[(0,a.jsxs)("span",{className:"block text-sm font-medium text-gray-900",children:[t.label," ",(0,a.jsxs)("span",{className:"text-xs text-gray-500 ml-1",children:["(",t.points,"点)"]})]}),t.description&&(0,a.jsx)("span",{className:"block text-xs text-gray-500",children:t.description})]})]})},d=e=>{var t;let{item:s,value:l,assistValue:r,onChange:n,onAssistChange:i}=e,c=l;return s.hasAssistance&&(c=l*(null!=r?r:0)),(0,a.jsxs)("div",{className:"p-4 border border-gray-200 rounded-md bg-white shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900",children:s.label}),(0,a.jsxs)("span",{className:"text-xs px-2 py-1 bg-gray-100 rounded text-gray-700 font-bold",children:["現在の点数: ",c,"点"]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs text-gray-500 block mb-1",children:"患者の状態"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:null==(t=s.options)?void 0:t.map(e=>(0,a.jsx)("button",{onClick:()=>n(e.value),className:"\n                  px-3 py-1.5 text-xs rounded border transition-colors\n                  ".concat(l===e.value?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50","\n                "),children:e.label},e.label))})]}),s.hasAssistance&&(0,a.jsxs)("div",{className:"pt-2 border-t border-gray-100 mt-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500 block mb-1",children:"介助の実施"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>null==i?void 0:i(1),className:"\n                   px-3 py-1.5 text-xs rounded border transition-colors flex items-center\n                   ".concat(1===r?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50","\n                 "),children:"あり (実施)"}),(0,a.jsx)("button",{onClick:()=>null==i?void 0:i(0),className:"\n                   px-3 py-1.5 text-xs rounded border transition-colors flex items-center\n                   ".concat(0===r?"bg-gray-500 text-white border-gray-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50","\n                 "),children:"なし (未実施)"})]}),1!==r&&(0,a.jsx)("p",{className:"text-xs text-red-500 mt-1",children:"※介助未実施のため 0点 となります"})]})]})]})},b="nursing_patients",x=(e,t)=>"".concat("nursing_assessment_").concat(e,"_").concat(t),m=(e,t)=>{let s=x(e,t),a=localStorage.getItem(s);return a?JSON.parse(a):null},u=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var p={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let h=(0,l.forwardRef)((e,t)=>{let{color:s="currentColor",size:a=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:c,iconNode:o,...d}=e;return(0,l.createElement)("svg",{ref:t,...p,width:a,height:a,stroke:s,strokeWidth:n?24*Number(r)/Number(a):r,className:u("lucide",i),...d},[...o.map(e=>{let[t,s]=e;return(0,l.createElement)(t,s)}),...Array.isArray(c)?c:[c]])}),g=((e,t)=>{let s=(0,l.forwardRef)((s,a)=>{let{className:r,...n}=s;return(0,l.createElement)(h,{ref:a,iconNode:t,className:u("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),r),...n})});return s.displayName="".concat(e),s})("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);function y(){let[e,t]=(0,l.useState)([]),[s,r]=(0,l.useState)(""),[n,i]=(0,l.useState)(""),[o,d]=(0,l.useState)(void 0);(0,l.useEffect)(()=>{i(new Date().toISOString().split("T")[0]),(()=>{let e=localStorage.getItem(b);return e?JSON.parse(e):localStorage.setItem(b,JSON.stringify([{id:"p001",name:"佐藤 太郎",gender:"1",birthday:"1950-01-01",admissionDate:"2024-04-01"},{id:"p002",name:"鈴木 花子",gender:"2",birthday:"1945-05-15",admissionDate:"2024-04-10"},{id:"p003",name:"田中 一郎",gender:"1",birthday:"1960-11-20",admissionDate:"2024-04-05"}]))})();let e=(()=>{let e=localStorage.getItem(b);return e?JSON.parse(e):[]})();t(e),e.length>0&&r(e[0].id)},[]),(0,l.useEffect)(()=>{if(!s||!n)return;let e=m(s,n);e?d(e.items):d(void 0)},[s,n]);let u=e.find(e=>e.id===s);return(0,a.jsxs)("div",{className:"flex h-screen bg-gray-100 overflow-hidden",children:[(0,a.jsxs)("div",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200 bg-blue-50",children:(0,a.jsxs)("h1",{className:"text-lg font-bold text-blue-800 flex items-center gap-2",children:[(0,a.jsx)(g,{className:"w-5 h-5"})," 患者一覧"]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:e.map(e=>(0,a.jsxs)("button",{onClick:()=>r(e.id),className:"w-full text-left p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors ".concat(s===e.id?"bg-blue-100 border-l-4 border-l-blue-600":""),children:[(0,a.jsx)("div",{className:"font-bold text-gray-800",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["1"===e.gender?"男性":"女性"," / ",e.birthday,"生"]})]},e.id))}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-200 text-xs text-gray-400 text-center",children:"Nursing Assessment System v1.0"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,a.jsx)(c,{patientName:null==u?void 0:u.name,currentDate:n,onDateChange:i,initialData:o,onSave:(e,t,a)=>{if(!s||!n)return void alert("患者または日付が選択されていません");var l={patientId:s,date:n,items:e,admissionFeeId:"acute_general_5",scores:t,isSevere:a};let r=x(l.patientId,l.date);localStorage.setItem(r,JSON.stringify(l))},onCopyPrevious:()=>{if(!s||!n)return;let e=((e,t)=>{let s=new Date(t);return isNaN(s.getTime())?null:(s.setDate(s.getDate()-1),m(e,s.toISOString().split("T")[0]))})(s,n);e?confirm("".concat(e.date," のデータをコピーしますか？"))&&d(e.items):alert("前日のデータが見つかりませんでした")}},"".concat(s,"-").concat(n))})]})}},6387:(e,t,s)=>{Promise.resolve().then(s.bind(s,1159))}},e=>{e.O(0,[441,255,358],()=>e(e.s=6387)),_N_E=e.O()}]);