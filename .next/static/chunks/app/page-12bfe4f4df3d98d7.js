(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6337:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>G});var s=a(5155),r=a(2115);let l=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:x,...h}=e;return(0,r.createElement)("svg",{ref:t,...n,width:s,height:s,stroke:a,strokeWidth:o?24*Number(i)/Number(s):i,className:l("lucide",c),...h},[...x.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let a=(0,r.forwardRef)((a,s)=>{let{className:n,...o}=a;return(0,r.createElement)(i,{ref:s,iconNode:t,className:l("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),n),...o})});return a.displayName="".concat(e),a},c=o("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),d=o("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),x=o("BedDouble",[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]]),h=o("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),g=e=>{let{activeTab:t,onTabChange:a}=e,r=[{id:"home",label:"ホーム",icon:c},{id:"patients",label:"患者管理",icon:d},{id:"inpatients",label:"入院患者",icon:x},{id:"wards",label:"病棟・病室",icon:x},{id:"settings",label:"マスタ設定",icon:h}];return(0,s.jsxs)("header",{className:"bg-white border-b border-gray-200 h-14 flex items-center px-4 shrink-0",children:[(0,s.jsx)("div",{className:"font-bold text-xl mr-8 text-blue-900",children:"HfileMaker"}),(0,s.jsx)("nav",{className:"flex h-full",children:r.map(e=>{let r=t===e.id,l=e.icon;return(0,s.jsxs)("button",{onClick:()=>a(e.id),className:"\n                flex items-center gap-2 px-4 h-full border-b-2 text-sm font-medium transition-colors\n                ".concat(r?"border-blue-600 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50","\n              "),children:[(0,s.jsx)(l,{className:"w-4 h-4"}),e.label]},e.id)})}),(0,s.jsx)("div",{className:"ml-auto flex items-center gap-4 text-xs text-gray-400",children:"Demo User"})]})},b=[{id:"a_wounds",category:"a",label:"創傷処置",points:1,inputType:"checkbox"},{id:"a_respiratory",category:"a",label:"呼吸ケア",points:1,inputType:"checkbox"},{id:"a_infusion",category:"a",label:"点滴ライン同時3本以上の管理",points:1,inputType:"checkbox"},{id:"a_ecg",category:"a",label:"心電図モニターの管理",points:1,inputType:"checkbox"},{id:"a_syringe_driver",category:"a",label:"シリンジポンプの管理",points:1,inputType:"checkbox"},{id:"a_emergency",category:"a",label:"救急搬送後の入院/緊急入院(2日間)",points:2,inputType:"checkbox"},{id:"a_special",category:"a",label:"専門的な治療・処置(抗悪性腫瘍剤等)",points:3,inputType:"checkbox"},{id:"b_bed_mobility",category:"b",label:"寝返り",points:2,inputType:"select",hasAssistance:!1,options:[{label:"できる(0点)",value:0,explanation:"手すり等を使わずに自力で寝返りができる"},{label:"何かにつかまればできる(1点)",value:1,explanation:"柵や介助バーを使用すれば可能"},{label:"できない(2点)",value:2,explanation:"自力では全くできない、または医学的安静で禁止されている"}]},{id:"b_transfer",category:"b",label:"移乗",points:2,inputType:"select",hasAssistance:!0,options:[{label:"自立(0点)",value:0,explanation:"乗り移り動作が自力で可能、または介助不要"},{label:"一部介助(1点)",value:1,explanation:"見守りや手を添える程度の介助が必要"},{label:"全介助(2点)",value:2,explanation:"抱え上げなど、人的な力が全面的に必要"}]},{id:"b_oral_care",category:"b",label:"口腔清潔",points:1,inputType:"select",hasAssistance:!0,options:[{label:"自立(0点)",value:0,explanation:"準備から実施まで一人で完結できる"},{label:"要介助(1点)",value:1,explanation:"物品の準備や仕上げ磨きなどに介助が必要"}]},{id:"b_eating",category:"b",label:"食事摂取",points:2,inputType:"select",hasAssistance:!0,options:[{label:"自立(0点)",value:0,explanation:"配膳された食事を自力で摂取できる"},{label:"一部介助(1点)",value:1,explanation:"小さく刻む、蓋を開ける、一部介助などが必要"},{label:"全介助(2点)",value:2,explanation:"経管栄養を含む、全ての摂取に介助が必要"}]},{id:"b_clothes",category:"b",label:"衣服の着脱",points:2,inputType:"select",hasAssistance:!0,options:[{label:"自立(0点)",value:0,explanation:"ボタン留め等含め、全て一人で可能"},{label:"一部介助(1点)",value:1,explanation:"背中を整える、靴下を履くなどに介助が必要"},{label:"全介助(2点)",value:2,explanation:"自分では着脱がほとんどできない"}]},{id:"b_instruction",category:"b",label:"診療・療養上の指示が通じる",points:1,inputType:"select",hasAssistance:!1,options:[{label:"はい(0点)",value:0},{label:"いいえ(1点)",value:1}]},{id:"b_danger",category:"b",label:"危険行動",points:2,inputType:"select",hasAssistance:!1,options:[{label:"ない(0点)",value:0},{label:"ある(2点)",value:2}]},{id:"c_thoraco",category:"c",label:"開胸手術(9日間)",points:1,inputType:"checkbox"},{id:"c_laparo",category:"c",label:"開腹手術(6日間)",points:1,inputType:"checkbox"},{id:"c_craniotomy",category:"c",label:"開頭手術(11日間)",points:1,inputType:"checkbox"},{id:"c_other_surgery",category:"c",label:"その他手術(5日間)",points:1,inputType:"checkbox"}],p={ACUTE_GENERAL_5:{id:"acute_general_5",name:"急性期一般入院料5",thresholds:{pattern1:{a:2,b:3},pattern2:{c:1}}}},u="nursing_patients_v3",m="nursing_admissions_v3",y="nursing_assessment_",f=()=>{let e=localStorage.getItem(u);return e?JSON.parse(e):[]},v=e=>{let t=localStorage.getItem(m);return(t?JSON.parse(t):[]).filter(t=>t.patientId===e)},j=(e,t)=>"".concat(y).concat(e,"_").concat(t);function N(e,t){var a,s,r,l,n,i;let o=0,c=0,d=0,x=t.items||{};b.forEach(e=>{let t=x[e.id];if("a"===e.category)!0===t&&(o+=e.points);else if("c"===e.category)!0===t&&(d+=e.points);else if("b"===e.category&&"number"==typeof t){let a=t;if(e.hasAssistance){let t=x["".concat(e.id,"_assist")];a*="number"==typeof t?t:0}c+=a}});let h=null!=(a=t.scoreA)?a:o,g=null!=(s=t.scoreB)?s:c,u=null!=(r=t.scoreC)?r:d;if(e===p.ACUTE_GENERAL_5.id){let e=p.ACUTE_GENERAL_5.thresholds,t=h>=(null!=(l=e.pattern1.a)?l:0)&&g>=(null!=(n=e.pattern1.b)?n:0),a=u>=(null!=(i=e.pattern2.c)?i:0);return t||a}return console.warn("Unknown admission fee ID: ".concat(e)),!1}let w=e=>{var t;let{item:a,currentValue:l,currentAssistValue:n,onSave:i,onClose:o,position:c}=e,d=(0,r.useRef)(null),[x,h]=r.useState(l),[g,b]=r.useState(null!=n?n:1);(0,r.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&o()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[o]);let p={top:c.y,left:c.x,zIndex:1e3};return(0,s.jsxs)("div",{ref:d,className:"fixed bg-white border border-gray-300 shadow-xl rounded-lg p-4 w-80 text-sm animate-in fade-in zoom-in-95 duration-100",style:p,children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3 pb-2 border-b border-gray-100",children:[(0,s.jsx)("h3",{className:"font-bold text-gray-800",children:a.label}),(0,s.jsx)("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[a.hasAssistance&&(0,s.jsxs)("div",{className:"bg-orange-50 p-2 rounded border border-orange-200 mb-2",children:[(0,s.jsx)("span",{className:"text-xs font-bold text-orange-800 block mb-1",children:"介助の実施"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>b(1),className:"flex-1 py-1 px-2 rounded text-xs border ".concat(1===g?"bg-orange-500 text-white border-orange-600":"bg-white text-gray-600 border-gray-300"),children:"あり (実施)"}),(0,s.jsx)("button",{onClick:()=>b(0),className:"flex-1 py-1 px-2 rounded text-xs border ".concat(0===g?"bg-gray-600 text-white border-gray-700":"bg-white text-gray-600 border-gray-300"),children:"なし (未実施)"})]}),(0,s.jsx)("p",{className:"text-[10px] text-orange-600 mt-1",children:"※「なし」を選択すると、項目の点数は0点になります。"})]}),"checkbox"===a.inputType?(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("button",{onClick:()=>{i(!0),o()},className:"p-3 text-left rounded border transition-colors ".concat(!0===l?"bg-blue-50 border-blue-500 text-blue-800 font-bold":"hover:bg-gray-50 border-gray-200"),children:"あり / 実施 (1点)"}),(0,s.jsx)("button",{onClick:()=>{i(!1),o()},className:"p-3 text-left rounded border transition-colors ".concat(!1===l?"bg-gray-100 border-gray-400 font-bold":"hover:bg-gray-50 border-gray-200"),children:"なし / 未実施 (0点)"}),a.description&&(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:a.description})]}):(0,s.jsx)("div",{className:"flex flex-col gap-2",children:null==(t=a.options)?void 0:t.map(e=>(0,s.jsxs)("button",{onClick:()=>{i(e.value,a.hasAssistance?g:void 0),o()},className:"p-3 text-left rounded border transition-colors group ".concat(l===e.value?"bg-green-50 border-green-500 ring-1 ring-green-500":"hover:bg-gray-50 border-gray-200"),children:[(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("span",{className:"font-bold ".concat(l===e.value?"text-green-800":"text-gray-700"),children:e.label})}),e.explanation&&(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1 group-hover:text-gray-700",children:e.explanation})]},e.value))})]}),(0,s.jsx)("div",{className:"mt-3 pt-2 border-t border-gray-100 text-right",children:(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"値を選択すると確定して閉じます"})})]})},k=o("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),S=o("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),_=o("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),C=o("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),M=o("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),D=e=>{var t,a,l,n;let{patientId:i,currentDate:o,onDateSelect:c,lastUpdated:d,onDirtyChange:x}=e,h=new Date(o),g=h.getFullYear(),p=h.getMonth()+1,u="".concat(g,"-").concat(String(p).padStart(2,"0")),m=Array.from({length:new Date(g,p,0).getDate()},(e,t)=>"".concat(g,"-").concat(String(p).padStart(2,"0"),"-").concat(String(t+1).padStart(2,"0"))),[f,v]=(0,r.useState)({});(0,r.useEffect)(()=>{v(((e,t)=>{let a={},s="".concat(y).concat(e,"_").concat(t);for(let e=0;e<localStorage.length;e++){let t=localStorage.key(e);if(t&&t.startsWith(s)){let e=localStorage.getItem(t);if(e){let t=JSON.parse(e);a[t.date]=t}}}return a})(i,u))},[i,u,d]);let D=(0,r.useMemo)(()=>{let e={a:[],b:[],c:[]};return b.forEach(t=>{e[t.category]&&e[t.category].push(t)}),e},[]),[E,A]=(0,r.useState)(null),[I,T]=(0,r.useState)({}),[z,L]=(0,r.useState)(null),O=Object.keys(I).length>0||!!E;(0,r.useEffect)(()=>{null==x||x(O);let e=e=>{O&&(e.preventDefault(),e.returnValue="")};return O&&window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[O,x]),(0,r.useEffect)(()=>{A(null),T({}),L(null)},[i]);let[H,V]=(0,r.useState)({isOpen:!1,item:null,position:{x:0,y:0}}),q=(0,r.useMemo)(()=>[...D.a,...D.b,...D.c],[D]),R=(e,t)=>{let a=0,s=0,r=0;return b.forEach(t=>{let l=e[t.id];if("a"===t.category&&!0===l&&(a+=t.points),"c"===t.category&&!0===l&&(r+=t.points),"b"===t.category&&"number"==typeof l){let a=l;if(t.hasAssistance){let s=e["".concat(t.id,"_assist")];a*="number"==typeof s?s:1}s+=a}}),{items:e,scoreA:a,scoreB:s,scoreC:r}},F=()=>{confirm("編集中の内容を破棄しますか？")&&(A(null),T({}),L(null),V({isOpen:!1,item:null,position:{x:0,y:0}}))},U=()=>{let e=Object.keys(I);e.forEach(e=>{(e=>{let t=j(e.patientId,e.date);localStorage.setItem(t,JSON.stringify(e))})(I[e])}),v(t=>{let a={...t};return e.forEach(e=>{a[e]=I[e]}),a}),A(null),T({}),L(null),L(null)};(0,r.useEffect)(()=>{if(!E||!z)return void V(e=>({...e,isOpen:!1}));let e=b.find(e=>e.id===z);if(!e)return;let t=document.querySelector('[data-cell-date="'.concat(E,'"][data-cell-item="').concat(z,'"]'));if(t){let a=t.getBoundingClientRect(),s=a.right+10,r=a.top+window.scrollY;s+320>window.innerWidth&&(s=a.left-320-10),V({isOpen:!0,item:e,position:{x:s,y:r}}),t.scrollIntoView({behavior:"smooth",block:"nearest"})}},[z,E]),(0,r.useEffect)(()=>{if(!E)return;let e=e=>{if(!e.metaKey&&!e.ctrlKey){if("ArrowDown"===e.key||"Enter"===e.key||"Tab"===e.key)e.preventDefault(),W(1);else if("ArrowUp"===e.key)e.preventDefault(),W(-1);else if(["0","1","2"].includes(e.key)&&z){let t=b.find(e=>e.id===z);if(t){let a=parseInt(e.key);if(e.preventDefault(),t.options){if(t.options.find(e=>e.value===a))return void B(t,a)}else if("checkbox"===t.inputType){1===a&&B(t,!0),0===a&&B(t,!1);return}}}}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[E,z,I,q]);let W=e=>{if(!z)return;let t=q.findIndex(e=>e.id===z);if(-1===t)return;let a=t+e;a>=0&&a<q.length&&L(q[a].id)},B=(e,t)=>{J(t,1),W(1)},J=(e,t)=>{if(!E||!I[E]||!z||!b.find(e=>e.id===z))return;let a=I[E],s={...a.items,[z]:e};"number"==typeof t&&(s["".concat(z,"_assist")]=t);let r=0,l=0,n=0;b.forEach(e=>{let t=s[e.id];if("a"===e.category&&!0===t&&(r+=e.points),"c"===e.category&&!0===t&&(n+=e.points),"b"===e.category&&"number"==typeof t){let a=t;if(e.hasAssistance){let t=s["".concat(e.id,"_assist")];a*="number"==typeof t?t:1}l+=a}});let i=N(a.admissionFeeId,{items:s,scoreA:r,scoreB:l,scoreC:n});T(e=>({...e,[E]:{...a,items:s,scores:{a:r,b:l,c:n},isSevere:i}}))};return(0,s.jsxs)("div",{className:"flex flex-col bg-white rounded-lg shadow mb-6 border border-gray-200 w-full overflow-hidden",children:[(0,s.jsx)("div",{className:"p-4 border-b border-gray-200 bg-gray-50 flex justify-between items-center",children:(0,s.jsxs)("h2",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:["月間評価推移 (",g,"年",p,"月)",E&&(0,s.jsxs)("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded flex items-center gap-1",children:[(0,s.jsx)(k,{className:"w-3 h-3"})," 編集中: ",E]})]})}),(0,s.jsx)("div",{className:"w-full overflow-x-auto max-h-[80vh]",children:(0,s.jsxs)("table",{className:"w-full text-xs text-center border-separate border-spacing-0",children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"p-2 border border-gray-300 min-w-[300px] text-left bg-gray-100 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)] outline outline-1 outline-gray-300",style:{position:"sticky",top:0,left:0,zIndex:60,background:"#f3f4f6"},children:"項目 / 日付"}),m.map((e,t)=>{let a=parseInt(e.split("-")[2]),r=e===o,l=e===E,n=new Date,d=e>"".concat(n.getFullYear(),"-").concat(String(n.getMonth()+1).padStart(2,"0"),"-").concat(String(n.getDate()).padStart(2,"0")),x=I[e],h=f[e],g=x||h,b=null==g?void 0:g.isSevere;return(0,s.jsx)("th",{className:"\n                      p-2 border border-gray-300 min-w-[60px] transition-colors relative group\n                      ".concat(l?"bg-yellow-50 border-yellow-400 border-2 border-b-0":"","\n                      ").concat(!l&&r?"bg-blue-600 text-white":"","\n                      ").concat(!l&&!r?"bg-gray-100 hover:bg-gray-200":"","\n                      ").concat(!l&&b?"bg-pink-100 text-red-800":"","\n                      ").concat(d?"bg-gray-50 cursor-not-allowed":"","\n                    "),style:{position:"sticky",top:0,zIndex:50},onClick:()=>!l&&!d&&c(e),children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1 ".concat(d?"opacity-50":""),children:[(0,s.jsx)("span",{children:a}),l?(0,s.jsxs)("div",{className:"flex gap-1 z-50 relative items-center",children:[(0,s.jsx)("button",{onClick:U,className:"p-1 bg-green-500 text-white rounded hover:bg-green-600",title:"保存",children:(0,s.jsx)(S,{className:"w-3 h-3"})}),(0,s.jsx)("button",{onClick:F,className:"p-1 bg-gray-500 text-white rounded hover:bg-gray-600",title:"キャンセル",children:(0,s.jsx)(_,{className:"w-3 h-3"})})]}):(0,s.jsxs)("div",{className:"h-5 flex gap-1 items-center justify-center",children:[t>0&&!f[e]&&!d&&(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{let t=m.indexOf(e);if(t<=0)return alert("前日のデータがありません");let a=f[m[t-1]];if(!a)return alert("前日のデータが登録されていません");if(E&&E!==e&&!confirm("他の日の編集を破棄してこの日を編集しますか？"))return;let s={...a.items},{scoreA:r,scoreB:l,scoreC:n}=R(s,a.admissionFeeId),o={patientId:i,date:e,items:s,admissionFeeId:a.admissionFeeId,scores:{a:r,b:l,c:n},isSevere:N(a.admissionFeeId,{items:s,scoreA:r,scoreB:l,scoreC:n})};T({[e]:o}),A(e),q.length>0&&L(q[0].id)})(e)},className:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"前日のデータをコピーして編集",children:(0,s.jsx)(C,{className:"w-3 h-3"})}),!d&&(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{if(E&&E!==e&&!confirm("他の日の編集を破棄してこの日を編集しますか？"))return;let t=f[e],a=(null==t?void 0:t.admissionFeeId)||"acute_general_5",{items:s,scoreA:r,scoreB:l,scoreC:n}=R((null==t?void 0:t.items)?{...t.items}:{},a),o={patientId:i,date:e,items:s,admissionFeeId:a,scores:{a:r,b:l,c:n},isSevere:N(a,{items:s,scoreA:r,scoreB:l,scoreC:n})};T({[e]:o}),A(e),q.length>0&&L(q[0].id)})(e)},className:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"編集",children:(0,s.jsx)(k,{className:"w-3 h-3"})})]}),!!x&&!l&&(0,s.jsx)("span",{className:"w-2 h-2 bg-red-500 rounded-full"})]})},e)})]})}),(0,s.jsxs)("tbody",{children:[(()=>{let e=e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"p-2 border border-gray-300 text-left bg-white truncate max-w-[300px] shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)] outline outline-1 outline-gray-300",title:e.label,style:{position:"sticky",left:0,zIndex:40,background:"white"},children:e.label}),m.map((t,a)=>{var r,l,n,i,d,x,h,g,b;let p=t===E,u=I[t],m=f[t],y=u||m,v=null==y||null==(r=y.items)?void 0:r[e.id],j="";"checkbox"===e.inputType?!0===v&&(j=(0,s.jsx)("span",{className:"text-blue-600 font-bold",children:"●"})):"number"==typeof v&&(j=v);let N=!1;if(u){let t="checkbox"!==e.inputType&&0;(null!=(i=null==(l=u.items)?void 0:l[e.id])?i:t)!==(null!=(d=null==m||null==(n=m.items)?void 0:n[e.id])?d:t)&&(N=!0),!N&&"b"===e.category&&e.hasAssistance&&(null!=(g=null==(x=u.items)?void 0:x["".concat(e.id,"_assist")])?g:1)!==(null!=(b=null==m||null==(h=m.items)?void 0:h["".concat(e.id,"_assist")])?b:1)&&(N=!0)}let w=p&&z===e.id;return(0,s.jsxs)("td",{"data-cell-date":t,"data-cell-item":e.id,className:"\n                            border border-gray-300 relative\n                            ".concat(p?"cursor-pointer":"","\n                            ").concat(p&&!w?"bg-white hover:bg-yellow-50":"","\n                            ").concat(w?"bg-yellow-200 outline outline-2 outline-blue-500 z-10":""," \n                            ").concat(p?"border-yellow-400 border-x-2":"","\n                            ").concat(!p&&(null==y?void 0:y.isSevere)?"bg-pink-50":"","\n                          "),onClick:a=>p&&((e,t,a)=>{if(E!==t){t!==o&&c(t);return}L(a.id)})(0,t,e),children:[j,N&&(0,s.jsx)("span",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"})]},t)})]},e.id),t=(e,t,a)=>(0,s.jsxs)("tr",{className:"".concat(a," font-bold"),children:[(0,s.jsx)("td",{className:"".concat(a," p-2 border shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"),style:{position:"sticky",left:0,zIndex:40},children:e}),m.map((e,a)=>{var r,l;let n=I[e],i=f[e],o=n||i,c=e===E;return(0,s.jsx)("td",{className:"border ".concat(c?"bg-yellow-50 border-yellow-400 border-x-2":""," ").concat(!c&&(null==o?void 0:o.isSevere)?"bg-pink-50":""),children:null!=(l=null==o||null==(r=o.scores)?void 0:r[t])?l:"-"},e)})]});return(0,s.jsxs)(s.Fragment,{children:[t("A項目 (得点)","a","bg-blue-50"),D.a.map(e),t("B項目 (得点)","b","bg-green-50"),D.b.map(e),t("C項目 (得点)","c","bg-gray-100"),D.c.map(e)]})})(),(0,s.jsxs)("tr",{className:"bg-gray-800 text-white font-bold",children:[(0,s.jsx)("td",{className:"p-2 border border-gray-600 text-left bg-gray-800 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)] outline outline-1 outline-gray-600",style:{position:"sticky",left:0,zIndex:40,background:"#1f2937",color:"white"},children:"判定結果"}),m.map((e,t)=>{let a=I[e],r=f[e],l=a||r;return l?e===E?(0,s.jsx)("td",{className:"border border-gray-600 bg-gray-700",children:(0,s.jsx)("button",{onClick:()=>(e=>{confirm("".concat(e," のデータを削除しますか？"))&&(((e,t)=>{let a=j(e,t);localStorage.removeItem(a)})(i,e),v(t=>{let a={...t};return delete a[e],a}),E===e&&F())})(e),className:"text-red-400 hover:text-red-200 p-1",title:"データを削除",children:(0,s.jsx)(M,{className:"w-4 h-4"})})},e):(0,s.jsx)("td",{className:"border border-gray-600 ".concat(l.isSevere?"bg-red-600":"bg-gray-700"),children:l.isSevere?"○":"\xd7"},e):(0,s.jsx)("td",{className:"border border-gray-600 bg-gray-100"},e)})]})]})]})}),H.isOpen&&H.item&&I[E]&&(0,s.jsx)(w,{item:H.item,currentValue:null==(a=I[E])||null==(t=a.items)?void 0:t[H.item.id],currentAssistValue:null==(n=I[E])||null==(l=n.items)?void 0:l["".concat(H.item.id,"_assist")],onSave:J,onClose:()=>V(e=>({...e,isOpen:!1})),position:H.position})]})},E=o("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),A=()=>{let[e,t]=(0,r.useState)([]),[a,l]=(0,r.useState)({}),[n,i]=(0,r.useState)(""),[o,c]=(0,r.useState)(""),[d,x]=(0,r.useState)(256),[h,g]=(0,r.useState)(!1),[b,p]=(0,r.useState)(0),[y,j]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=e=>{h&&x(Math.max(200,Math.min(600,e.clientX)))},t=()=>g(!1);return h&&(window.addEventListener("mousemove",e),window.addEventListener("mouseup",t)),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}},[h]),(0,r.useEffect)(()=>{let e=new Date;c("".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"))),(()=>{let e=localStorage.getItem(u);if(e)return JSON.parse(e);{let{patients:e,admissions:t}=(()=>{let e=[],t=[];for(let a=1;a<=60;a++){let s=String(a).padStart(3,"0"),r=a%2==0,l=1940+a%50,n=String(a%12+1).padStart(2,"0"),i=String(a%28+1).padStart(2,"0"),o="".concat(l,"-").concat(n,"-").concat(i),c=String((a+3)%12+1).padStart(2,"0"),d=String((a+5)%28+1).padStart(2,"0"),x="2024-".concat(c,"-").concat(d),h=["西病棟","東病棟","南病棟"][a%3],g="".concat(a%5+1,"0").concat(a%10),b=a%5==0,p=a%7==0;!function(a,s,r,l,n,i){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],d="p".concat(a);e.push({id:d,identifier:"100".concat(a),name:s,gender:r,birthDate:l,postalCode:"100-0001",address:"東京都千代田区千代田1-1",memo:c?"入退院を繰り返しています":o?"退院済み":"特記事項なし"}),c&&t.push({id:"adm".concat(a,"_past"),patientId:d,admissionDate:"2023-01-10",dischargeDate:"2023-02-15",initialWard:"東病棟",initialRoom:"201"}),t.push({id:"adm".concat(a),patientId:d,admissionDate:n,dischargeDate:o?"2024-05-20":void 0,initialWard:"一般病棟",initialRoom:i})}(s,"ダミー 患者".concat(a),r?"2":"1",o,x,g,b,p),t.length>0&&(t[t.length-1].initialWard=h)}return{patients:e,admissions:t}})();return localStorage.setItem(u,JSON.stringify(e)),localStorage.setItem(m,JSON.stringify(t))}})();let a=f();t(a);let s={};a.forEach(e=>{s[e.id]=v(e.id)}),l(s),a.length>0&&i(a[0].id)},[]),(0,s.jsxs)("div",{className:"flex flex-1 h-full overflow-hidden bg-gray-100 relative",children:[(0,s.jsxs)("div",{className:"bg-white border-r border-gray-200 flex flex-col shrink-0 relative group",style:{width:d},children:[(0,s.jsx)("div",{className:"absolute right-0 top-0 h-full w-4 cursor-col-resize z-50 flex flex-col justify-start pt-32 items-center -mr-2 select-none",onMouseDown:e=>{e.preventDefault(),g(!0)},children:(0,s.jsx)("div",{className:"w-1.5 h-16 bg-gray-300 rounded-full transition-colors hover:bg-gray-500 shadow-sm"})}),(0,s.jsx)("div",{className:"p-4 border-b border-gray-200 bg-blue-50",children:(0,s.jsxs)("h1",{className:"text-lg font-bold text-blue-800 flex items-center gap-2",children:[(0,s.jsx)(E,{className:"w-5 h-5"})," 患者一覧"]})}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:e.map(e=>{let t=(a[e.id]||[]).sort((e,t)=>t.admissionDate.localeCompare(e.admissionDate))[0],r=t&&(!t.dischargeDate||t.dischargeDate>=o),l=t?"".concat(t.admissionDate," 入院"):"未入院";return(0,s.jsxs)("button",{onClick:()=>(e=>{n!==e&&(!y||confirm("編集中のデータがあります。破棄して別の患者へ移動しますか？"))&&(i(e),j(!1))})(e.id),className:"w-full text-left p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors ".concat(n===e.id?"bg-blue-100 border-l-4 border-l-blue-600":""),children:[(0,s.jsxs)("div",{className:"font-bold text-gray-800",children:[e.name," ",(0,s.jsxs)("span",{className:"text-xs font-normal text-gray-500",children:["(",e.identifier,")"]})]}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["1"===e.gender?"男性":"女性"," / ",e.birthDate,"生 / ",(0,s.jsx)("span",{className:r?"text-blue-600 font-bold":"",children:l})]})]},e.id)})}),(0,s.jsx)("div",{className:"p-4 border-t border-gray-200 text-xs text-gray-400 text-center",children:"Nursing Assessment System v1.1"})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-4 flex flex-col gap-4",children:n&&o&&(0,s.jsx)("section",{className:"w-full min-w-0",children:(0,s.jsx)(D,{patientId:n,currentDate:o,onDateSelect:c,lastUpdated:b,onDirtyChange:j})})})]})},I=o("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),T=o("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),z=o("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),L=()=>(0,s.jsxs)("div",{className:"p-8 h-full bg-gray-50 overflow-y-auto",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"ダッシュボード (当月統計)"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,s.jsx)(O,{title:"入院患者数",value:"42",subtext:"前月比 +3",icon:d,color:"blue"}),(0,s.jsx)(O,{title:"重症度該当率",value:"38%",subtext:"目標: 35%以上",icon:I,color:"green"}),(0,s.jsx)(O,{title:"A項目 2点以上",value:"15",subtext:"平均推移: 横ばい",icon:T,color:"purple"}),(0,s.jsx)(O,{title:"未評価アラート",value:"2",subtext:"要確認",icon:z,color:"red"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 h-64 flex items-center justify-center text-gray-400",children:"[重症度推移グラフ エリア]"}),(0,s.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 h-64 flex items-center justify-center text-gray-400",children:"[病棟別訳あり患者分布 エリア]"})]})]}),O=e=>{let{title:t,value:a,subtext:r,icon:l,color:n}=e;return(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:t}),(0,s.jsx)("h3",{className:"text-3xl font-bold text-gray-800 mt-1",children:a})]}),(0,s.jsx)("div",{className:"p-3 rounded-full ".concat({blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",purple:"bg-purple-100 text-purple-600",red:"bg-red-100 text-red-600"}[n]),children:(0,s.jsx)(l,{className:"w-6 h-6"})})]}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:r})]})},H=()=>(0,s.jsxs)("div",{className:"p-8 h-full bg-gray-50 flex flex-col items-center justify-center text-gray-400",children:[(0,s.jsx)("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:(0,s.jsx)(x,{className:"w-12 h-12"})}),(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-600",children:"病棟・病室管理"}),(0,s.jsx)("p",{className:"mt-2",children:"この機能は現在開発中です (Phase 2)"})]}),V=o("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),q=o("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),R=o("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),F=o("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),U=o("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),W=o("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),B=o("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),J=o("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),P=e=>{let{patient:t,admissions:a,onBack:l}=e,[n,i]=(0,r.useState)("basic"),[o,c]=(0,r.useState)(new Date().toISOString().split("T")[0]);return(0,s.jsxs)("div",{className:"flex flex-col h-full bg-gray-50",children:[(0,s.jsxs)("div",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center gap-4 shrink-0 shadow-sm",children:[(0,s.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,s.jsx)(B,{className:"w-5 h-5 text-gray-600"})}),(0,s.jsx)("div",{children:(0,s.jsxs)("h2",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[t.name,(0,s.jsxs)("span",{className:"text-sm font-normal text-gray-500",children:["(",t.identifier,")"]})]})})]}),(0,s.jsxs)("div",{className:"px-6 pt-4 flex gap-1 border-b border-gray-200 shrink-0",children:[(0,s.jsxs)("button",{onClick:()=>i("basic"),className:"px-4 py-2 text-sm font-medium rounded-t-lg flex items-center gap-2 border-t border-l border-r border-transparent\n              ".concat("basic"===n?"bg-white text-blue-600 border-gray-200 border-b-white translate-y-[1px]":"text-gray-500 hover:text-gray-700 hover:bg-gray-100","\n            "),children:[(0,s.jsx)(E,{className:"w-4 h-4"})," 基本情報・入院歴"]}),(0,s.jsxs)("button",{onClick:()=>i("matrix"),className:"px-4 py-2 text-sm font-medium rounded-t-lg flex items-center gap-2 border-t border-l border-r border-transparent\n              ".concat("matrix"===n?"bg-white text-blue-600 border-gray-200 border-b-white translate-y-[1px]":"text-gray-500 hover:text-gray-700 hover:bg-gray-100","\n            "),children:[(0,s.jsx)(I,{className:"w-4 h-4"})," 看護必要度マトリクス"]})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:["basic"===n&&(0,s.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,s.jsxs)("h3",{className:"text-md font-bold text-gray-800 mb-4 flex items-center gap-2",children:[(0,s.jsx)(J,{className:"w-4 h-4"})," 患者基本情報"]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"患者ID"}),(0,s.jsx)("p",{className:"mt-1 font-mono text-gray-800",children:t.identifier})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"氏名"}),(0,s.jsx)("p",{className:"mt-1 text-gray-800",children:t.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"性別"}),(0,s.jsx)("p",{className:"mt-1 text-gray-800",children:"1"===t.gender?"男性":"女性"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"生年月日"}),(0,s.jsx)("p",{className:"mt-1 text-gray-800",children:t.birthDate})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,s.jsxs)("h3",{className:"text-md font-bold text-gray-800 mb-4 flex items-center gap-2",children:[(0,s.jsx)(I,{className:"w-4 h-4"})," 入院歴"]}),a.length>0?(0,s.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,s.jsxs)("div",{className:"p-4 bg-gray-50 rounded border border-gray-100",children:[(0,s.jsxs)("div",{className:"flex font-semibold text-gray-700 mb-2",children:[e.admissionDate," 〜 ",e.dischargeDate||"継続中"]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["開始病棟: ",e.initialWard||"-"," ",e.initialRoom,"号室"]})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-400",children:"入院歴はありません"})]})]}),"matrix"===n&&(0,s.jsx)("div",{className:"h-full bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:(0,s.jsx)(D,{patientId:t.id,currentDate:o,onDateSelect:c})})]})]})},Y=()=>{let[e,t]=(0,r.useState)([]),[a,l]=(0,r.useState)({}),[n,i]=(0,r.useState)(null),[o,c]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[g,b]=(0,r.useState)(""),[p,u]=(0,r.useState)(""),[m,y]=(0,r.useState)(1);(0,r.useEffect)(()=>{let e=f();t(e);let a={};e.forEach(e=>{a[e.id]=v(e.id)}),l(a)},[]);let j=(0,r.useMemo)(()=>e.filter(e=>!!(e.name.includes(o)||e.identifier&&e.identifier.includes(o))&&(!x||e.birthDate===x)&&(!g&&!p||!!(a[e.id]||[]).some(e=>{let t=e.admissionDate,a=e.dischargeDate||"9999-12-31",s=g||"0000-01-01";return t<=(p||"9999-12-31")&&a>=s}))&&!0).sort((e,t)=>t.id.localeCompare(e.id)),[e,o,x,g,p,a]),N=Math.ceil(j.length/20),w=j.slice((m-1)*20,20*m);if(n)return(0,s.jsx)(P,{patient:n,admissions:a[n.id]||[],onBack:()=>i(null)});let k=(e,t)=>{e(t),y(1)};return(0,s.jsxs)("div",{className:"flex flex-col h-full bg-gray-50 text-lg",children:[" ",(0,s.jsxs)("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center shrink-0",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[(0,s.jsx)(d,{className:"w-8 h-8 text-blue-600"}),"患者管理"]}),(0,s.jsxs)("button",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 shadow-sm transition-colors flex items-center gap-2 font-bold text-lg",children:[(0,s.jsx)(V,{className:"w-5 h-5"})," 新規患者登録"]})]}),(0,s.jsxs)("div",{className:"bg-white border-b border-gray-200 px-6 py-4 flex flex-wrap gap-4 items-end shrink-0 shadow-sm",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-gray-500 mb-1",children:"キーワード検索"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(q,{className:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,s.jsx)("input",{type:"text",placeholder:"氏名・ID...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md w-64 focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg",value:o,onChange:e=>k(c,e.target.value)})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-gray-500 mb-1",children:"生年月日"}),(0,s.jsx)("input",{type:"date",className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg",value:x,onChange:e=>k(h,e.target.value)})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-gray-500 mb-1",children:"入院期間 (開始)"}),(0,s.jsx)("input",{type:"date",className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg",value:g,onChange:e=>k(b,e.target.value)})]}),(0,s.jsx)("span",{className:"text-gray-400 mt-8",children:"〜"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-gray-500 mb-1",children:"入院期間 (終了)"}),(0,s.jsx)("input",{type:"date",className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg",value:p,onChange:e=>k(u,e.target.value)})]})]})]}),(0,s.jsx)("div",{className:"p-6 flex-1 overflow-auto",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,s.jsxs)("table",{className:"w-full text-left",children:[(0,s.jsx)("thead",{className:"bg-gray-50 text-gray-600 font-bold border-b border-gray-200 text-lg",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-4 whitespace-nowrap",children:"患者ID"}),(0,s.jsx)("th",{className:"px-6 py-4 whitespace-nowrap",children:"氏名"}),(0,s.jsx)("th",{className:"px-6 py-4 whitespace-nowrap",children:"性別"}),(0,s.jsx)("th",{className:"px-6 py-4 whitespace-nowrap",children:"生年月日"}),(0,s.jsx)("th",{className:"px-6 py-4 whitespace-nowrap",children:"メモ"}),(0,s.jsx)("th",{className:"px-6 py-4 min-w-[300px]",children:"最新の入院歴"}),(0,s.jsx)("th",{className:"px-6 py-4 text-right",children:"操作"})]})}),(0,s.jsxs)("tbody",{className:"divide-y divide-gray-100",children:[w.map(e=>{let t=(a[e.id]||[]).sort((e,t)=>t.admissionDate.localeCompare(e.admissionDate))[0],r=t?"".concat(t.admissionDate," 〜 ").concat(t.dischargeDate||"入院中"):"記録なし",l=t?"".concat(t.initialWard||"-"," / ").concat(t.initialRoom||"-"):"-";return(0,s.jsxs)("tr",{onClick:()=>i(e),className:"hover:bg-blue-50 transition-colors cursor-pointer group text-xl",children:[(0,s.jsx)("td",{className:"px-6 py-4 font-mono text-gray-600",children:e.identifier}),(0,s.jsx)("td",{className:"px-6 py-4 font-bold text-gray-800",children:e.name}),(0,s.jsx)("td",{className:"px-6 py-4 text-gray-600",children:"1"===e.gender?"男性":"2"===e.gender?"女性":"その他"}),(0,s.jsx)("td",{className:"px-6 py-4 text-gray-600 font-mono",children:e.birthDate}),(0,s.jsx)("td",{className:"px-6 py-4 text-gray-500 text-lg max-w-xs truncate",children:e.memo||"-"}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"font-medium text-gray-700 flex items-center gap-2",children:[(0,s.jsx)(R,{className:"w-5 h-5 text-gray-400"})," ",r]}),(0,s.jsxs)("div",{className:"text-base text-gray-500 mt-1 ml-7",children:["病棟: ",l]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 text-right",children:(0,s.jsx)("button",{className:"text-blue-600 hover:text-blue-800 p-3 rounded-full hover:bg-blue-100 opacity-0 group-hover:opacity-100 transition-all",children:(0,s.jsx)(F,{className:"w-6 h-6"})})})]},e.id)}),0===w.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500 text-lg",children:"条件に一致する患者が見つかりません"})})]})]}),(0,s.jsxs)("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["全 ",j.length," 件中 ",Math.min((m-1)*20+1,j.length)," - ",Math.min(20*m,j.length)," 件を表示"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>y(e=>Math.max(1,e-1)),disabled:1===m,className:"p-2 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed",children:(0,s.jsx)(U,{className:"w-6 h-6"})}),(0,s.jsxs)("span",{className:"text-lg font-medium text-gray-700 px-2",children:["page ",m," / ",Math.max(1,N)]}),(0,s.jsx)("button",{onClick:()=>y(e=>Math.min(N,e+1)),disabled:m===N||0===N,className:"p-2 rounded hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed",children:(0,s.jsx)(W,{className:"w-6 h-6"})})]})]})]})})]})};function G(){let[e,t]=(0,r.useState)("home");return(0,s.jsxs)("div",{className:"flex flex-col h-screen bg-gray-100 overflow-hidden",children:[(0,s.jsx)(g,{activeTab:e,onTabChange:t}),(0,s.jsxs)("main",{className:"flex-1 overflow-hidden relative",children:["home"===e&&(0,s.jsx)(L,{}),"inpatients"===e&&(0,s.jsx)(A,{}),"patients"===e&&(0,s.jsx)(Y,{}),"wards"===e&&(0,s.jsx)(H,{}),"settings"===e&&(0,s.jsx)("div",{className:"p-8 text-center text-gray-400",children:"設定画面 (Coming Soon)"})]})]})}},6387:(e,t,a)=>{Promise.resolve().then(a.bind(a,6337))}},e=>{e.O(0,[441,255,358],()=>e(e.s=6387)),_N_E=e.O()}]);